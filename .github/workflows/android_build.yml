- name: Locate and Package Windows Build
        shell: pwsh
        run: |
          # 1. 打印目录树，这样如果报错，我们一眼就能看到文件夹在哪
          Write-Host "Searching for build output..."
          Get-ChildItem -Path . -Recurse -Directory -Filter "Release" | Select-Object FullName
          
          # 2. 尝试几种常见的 Flutter Windows 输出路径
          $possiblePaths = @(
              "simple_live_app\build\windows\x64\runner\Release",
              "simple_live_app\build\windows\runner\Release",
              "build\windows\x64\runner\Release"
          )

          $foundPath = $null
          foreach ($path in $possiblePaths) {
              if (Test-Path $path) {
                  $foundPath = $path
                  break
              }
          }

          # 3. 如果找到了就打包，找不到就报出所有文件结构供参考
          if ($foundPath) {
              Write-Host "Success! Found build at: $foundPath"
              Compress-Archive -Path "$foundPath\*" -DestinationPath "simple_live_win_x64.zip"
          } else {
              Write-Host "Could not find standard paths. Listing all files for debugging:"
              dir -Recurse
              exit 1
          }

      - name: Upload Windows Artifact
        uses: actions/upload-artifact@v4
        with:
          name: simple_live_win_x64
          path: simple_live_win_x64.zip
